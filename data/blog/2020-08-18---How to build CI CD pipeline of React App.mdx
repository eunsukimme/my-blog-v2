---
title: AWS S3, IAM ê·¸ë¦¬ê³  CodeBuild ë¡œ React í”„ë¡œì íŠ¸ CI/CD êµ¬ì¶•í•˜ê¸°
summary: AWS S3, IAM, CodeBuild ë¥¼ í™œìš©í•´ React í”„ë¡œì íŠ¸ë¥¼ í˜¸ìŠ¤íŒ…í•˜ëŠ” CI/CD íŒŒì´í”„ë¼ì¸ì„ êµ¬ì¶•í•˜ëŠ” ë°©ë²•ì— ëŒ€í•´ì„œ ì•Œì•„ë´…ì‹œë‹¤.
date: '2020-08-18T21:30:00.000Z'
draft: false
slug: 'react-cicd-pipeline-with-aws-s3-iam-codebuild'
category: DevOps
tags:
  - DevOps
  - React
  - AWS
  - Cloud
  - S3
  - IAM
  - CodeBuild
socialImage: '/static/media/react_s3_codebuild/codebuild.png'
---

ì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œëŠ” AWS S3, IAM ê·¸ë¦¬ê³  CodeBuild ë¥¼ í™œìš©í•˜ì—¬ Github ì— ì €ì¥ëœ React Application ì˜ CI/CD íŒŒì´í”„ë¼ì¸ì„ êµ¬ì¶•í•˜ëŠ” ë°©ë²•ì— ëŒ€í•´ ì•Œì•„ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤. í¬ìŠ¤íŒ…ì— ì•ì„œ ì´ë¯¸ React App ì´ Github remote repository ì— ë“±ë¡ë˜ì–´ ìˆë‹¤ê³  ê°€ì •í•˜ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.

## 1. Create S3 Bucket

### 1-1. Initial Setting to Create Bucket

ë¨¼ì € ë¹Œë“œëœ React íŒŒì¼ì„ í˜¸ìŠ¤íŒ… í•  S3 ë²„í‚·ì„ ìƒì„±í•´ì¤ë‹ˆë‹¤.

![/static/media/react_s3_codebuild/Screen_Shot_2020-08-18_at_6.33.45_PM.png](/static/media/react_s3_codebuild/Screen_Shot_2020-08-18_at_6.33.45_PM.png)

ì›í•˜ëŠ” ì´ë¦„ìœ¼ë¡œ ë²„í‚·ì„ ë§Œë“¤ì–´ì¤ì‹œë‹¤. ì—¬ê¸°ì„œëŠ” `lovo-s3-codebuild` ë¼ê³  í•˜ì˜€ìŠµë‹ˆë‹¤.

![/static/media/react_s3_codebuild/Screen_Shot_2020-08-18_at_6.35.14_PM.png](/static/media/react_s3_codebuild/Screen_Shot_2020-08-18_at_6.35.14_PM.png)

ë‹¤ìŒìœ¼ë¡œ Properties ì—ì„œëŠ” ì•„ë¬´ ì„¤ì •ì„ í•˜ì§€ ì•Šê³  ë„˜ì–´ê°€ì¤ì‹œë‹¤.

![/static/media/react_s3_codebuild/Screen_Shot_2020-08-18_at_6.35.53_PM.png](/static/media/react_s3_codebuild/Screen_Shot_2020-08-18_at_6.35.53_PM.png)

ì´ ë²„í‚·ì€ Public Access ê°€ ê°€ëŠ¥í•˜ì—¬ì•¼ í•˜ë¯€ë¡œ `Block all public access` ì²´í¬ë°•ìŠ¤ë¥¼ í•´ì œí•´ì¤€ ë’¤ ë„˜ì–´ê°€ì¤ì‹œë‹¤.

![/static/media/react_s3_codebuild/Screen_Shot_2020-08-18_at_6.36.13_PM.png](/static/media/react_s3_codebuild/Screen_Shot_2020-08-18_at_6.36.13_PM.png)

ë§ˆì§€ë§‰ìœ¼ë¡œ `Create Bucket` ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ ë²„í‚·ì´ ìƒì„±ë©ë‹ˆë‹¤. ì´ë ‡ê²Œ ë§Œë“¤ì–´ì§„ ë²„í‚·ì„ í´ë¦­í•´ë´…ì‹œë‹¤.

![/static/media/react_s3_codebuild/Screen_Shot_2020-08-18_at_6.38.01_PM.png](/static/media/react_s3_codebuild/Screen_Shot_2020-08-18_at_6.38.01_PM.png)

### 1-2. Setting to Host Website

`Properties` íƒ­ì„ ì„ íƒí•©ë‹ˆë‹¤.

![/static/media/react_s3_codebuild/Screen_Shot_2020-08-18_at_6.38.48_PM.png](/static/media/react_s3_codebuild/Screen_Shot_2020-08-18_at_6.38.48_PM.png)

`Static website hosting` ì´ í˜„ì¬ `Disabled` ë˜ìˆë‹¤ê³  ë‚˜íƒ€ë‚˜ëŠ”ë°, ì´ë¥¼ í´ë¦­í•´ì„œ `Enable` ë˜ë„ë¡ í•´ì¤ì‹œë‹¤.

![/static/media/react_s3_codebuild/Screen_Shot_2020-08-18_at_6.39.03_PM.png](/static/media/react_s3_codebuild/Screen_Shot_2020-08-18_at_6.39.03_PM.png)

ì´ë•Œ `Use this bucket to host a website` ë€ ì˜µì…˜ì„ ì„ íƒí•˜ê³ , `Index document` ì™€ `Error Document` ë¥¼ ëª¨ë‘ `index.html` ë¡œ ì„¤ì •í•´ì¤ì‹œë‹¤. Error Document ë„ ë™ì¼í•˜ê²Œ ì„¤ì •í•˜ëŠ” ì´ìœ ëŠ” React App ì€ SPA(Single Page Application) ì´ë¯€ë¡œ Error page ë¥¼ ê°œë°œìê°€ ì»¤ìŠ¤í…€í•˜ê²Œ ë§Œë“¤ì–´ì£¼ê¸° ìœ„í•¨ì…ë‹ˆë‹¤.

ì—¬ê¸°ì„œëŠ” ì¤‘ìš”í•˜ì§€ ì•Šìœ¼ë‹ˆ ë‹¤ìŒìœ¼ë¡œ ë„˜ì–´ê°€ì¤ì‹œë‹¤.

![/static/media/react_s3_codebuild/Screen_Shot_2020-08-18_at_6.39.24_PM.png](/static/media/react_s3_codebuild/Screen_Shot_2020-08-18_at_6.39.24_PM.png)

`Properties` ì˜¤ë¥¸ìª½ì— ìˆëŠ” `Permission` íƒ­ì€ ì„ íƒí•©ë‹ˆë‹¤.

![/static/media/react_s3_codebuild/Screen_Shot_2020-08-18_at_6.41.08_PM.png](/static/media/react_s3_codebuild/Screen_Shot_2020-08-18_at_6.41.08_PM.png)

ì—¬ê¸°ì„œëŠ” ë²„í‚·ì˜ Policy ë¥¼ ì •ì˜í•  ìˆ˜ ìˆëŠ”ë°, ì•„ë˜ì˜ ì½”ë“œë¥¼ ë³µì‚¬í•œ ë’¤ ë¶™ì—¬ë„£ì–´ ì£¼ì„¸ìš”. ì•„ë˜ ì½”ë“œëŠ” í˜„ì¬ S3 ë²„í‚·ì— ì¡´ì¬í•˜ëŠ” ëª¨ë“  ì˜¤ë¸Œì íŠ¸ì— ê³µê°œì ìœ¼ë¡œ ì½ê¸° ê¶Œí•œì„ ë¶€ì—¬í•©ë‹ˆë‹¤. ê·¸ëŸ° ë‹¤ìŒ `<YOUR_BUCKET_NAME>` ë¶€ë¶„ì„ ìœ„ì—ì„œ ìƒì„±í•œ ë²„í‚·ì˜ ì´ë¦„ìœ¼ë¡œ ë³€ê²½í•´ì£¼ë©´ ë©ë‹ˆë‹¤.

```json
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Sid": "PublicReadGetObject",
      "Effect": "Allow",
      "Principal": "*",
      "Action": "s3:GetObject",
      "Resource": "arn:aws:s3:::<YOUR_BUCKET_NAME>/*"
    }
  ]
}
```

![/static/media/react_s3_codebuild/Screen_Shot_2020-08-18_at_6.42.32_PM.png](/static/media/react_s3_codebuild/Screen_Shot_2020-08-18_at_6.42.32_PM.png)

ì, ì´ë ‡ê²Œ í•´ì„œ ë²ˆë“¤ë§ ëœ React App ì„ í˜¸ìŠ¤íŒ… í•  ë²„í‚·ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.

---

## 2. Create IAM Role for S3 Access

CodeBuild ë¥¼ í™œìš©í•˜ë©´ ì¡°ê¸ˆ ì „ ìƒì„±í•œ ë²„í‚·ì— access í•´ì•¼í•˜ëŠ”ë°, ì´ë¥¼ í—ˆìš©í•˜ë„ë¡ IAM Role ì„ ë§Œë“¤ì–´ ì¤ì‹œë‹¤. ë¨¼ì € IAM ì„œë¹„ìŠ¤ì—ì„œ `Create role` ë²„íŠ¼ì„ í´ë¦­í•˜ì—¬ ìƒˆë¡œìš´ Role ì„ ë§Œë“¤ì–´ì¤ì‹œë‹¤.

![/static/media/react_s3_codebuild/Screen_Shot_2020-08-18_at_6.49.00_PM.png](/static/media/react_s3_codebuild/Screen_Shot_2020-08-18_at_6.49.00_PM.png)

ìœ ìŠ¤ì¼€ì´ìŠ¤ë¡œ `CodeBuild` ë¥¼ ì„ íƒí•˜ê³  ë‹¤ìŒìœ¼ë¡œ ë„˜ì–´ê°€ ì¤ì‹œë‹¤.

![/static/media/react_s3_codebuild/Screen_Shot_2020-08-18_at_6.51.40_PM.png](/static/media/react_s3_codebuild/Screen_Shot_2020-08-18_at_6.51.40_PM.png)

`s3fullaccess` ë¡œ ê²€ìƒ‰í•˜ê³ , í•´ë‹¹ Policy ë¥¼ ì„ íƒí•œ ë‹¤ìŒ ë‹¤ìŒìœ¼ë¡œ ë„˜ì–´ê°‘ì‹œë‹¤. ê·¸ëŸ¬ë©´ íƒœê·¸ë¥¼ ì„¤ì •í•  ìˆ˜ ìˆëŠ”ë° ë°”ë¡œ ì—¬ê¸°ì„œëŠ” ë°”ë¡œ ë„˜ì–´ê°€ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.

![/static/media/react_s3_codebuild/Screen_Shot_2020-08-18_at_6.53.36_PM.png](/static/media/react_s3_codebuild/Screen_Shot_2020-08-18_at_6.53.36_PM.png)

ë§ˆì§€ë§‰ìœ¼ë¡œ Role ì˜ ì´ë¦„ì„ ì„¤ì •í•˜ë©´ ë©ë‹ˆë‹¤. ì—¬ê¸°ì„œëŠ” `ReactS3CodeBuildRole` ì´ë¼ê³  ê°„ë‹¨í•˜ê²Œ ì •ì˜í–ˆìŠµë‹ˆë‹¤. ì˜¤ë¥¸ìª½ ì•„ë˜ `Create role` ë²„íŠ¼ì„ ëˆŒëŸ¬ì„œ IAM Role ìƒì„±ì„ ì™„ë£Œí•´ì¤ì‹œë‹¤.

![/static/media/react_s3_codebuild/Screen_Shot_2020-08-18_at_6.54.20_PM.png](/static/media/react_s3_codebuild/Screen_Shot_2020-08-18_at_6.54.20_PM.png)

---

## 3. Create CodeBuild Project

S3 ë²„í‚·ë„ ë§Œë“¤ê³  IAM Role ë„ ìƒì„± í–ˆìœ¼ë‹ˆ ì´ì œ ë³¸ê²©ì ìœ¼ë¡œ CodeBuild ë¥¼ í™œìš©í•´ ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.

### Project Configuration

ë¨¼ì € CodeBuild ì„œë¹„ìŠ¤ì—ì„œ `Create build project` ë¥¼ í´ë¦­í•´ì„œ ìƒˆë¡œìš´ ë¹Œë“œ í”„ë¡œì íŠ¸ë¥¼ ë§Œë“¤ì–´ ì¤ì‹œë‹¤.

![/static/media/react_s3_codebuild/Screen_Shot_2020-08-18_at_6.43.31_PM.png](/static/media/react_s3_codebuild/Screen_Shot_2020-08-18_at_6.43.31_PM.png)

ì œì¼ ë¨¼ì € í”„ë¡œì íŠ¸ ì´ë¦„ì„ ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì—¬ê¸°ì„œëŠ” `React-S3-CodeBuild` ë¼ê³  ì´ë¦„ì„ ì§€ì—ˆìŠµë‹ˆë‹¤.

![/static/media/react_s3_codebuild/Screen_Shot_2020-08-18_at_6.44.09_PM.png](/static/media/react_s3_codebuild/Screen_Shot_2020-08-18_at_6.44.09_PM.png)

### Source

ë‹¤ìŒìœ¼ë¡œ CodeBuild ê°€ ì–´ë””ì„œ ì½”ë“œë¥¼ ê°€ì ¸ì˜¬ ê²ƒì¸ì§€ë¥¼ ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì—¬ê¸°ì„œëŠ” `Source provider` ë¥¼ `Github` ìœ¼ë¡œ ì„¤ì •í•´ì£¼ê³ , `Repository` ë¥¼ `Repository in my Github account` ë¡œ ì„¤ì •í•´ ì¤ì‹œë‹¤.

ê·¸ë¦¬ê³  `Github repository` ëŠ” ì‚¬ì „ì— React App ì´ ë“±ë¡ëœ repository ë¥¼ ì„ íƒí•´ ì£¼ë©´ ë©ë‹ˆë‹¤. ë‹¤ìŒìœ¼ë¡œ `Source version` ìœ¼ë¡œ ì–´ë–¤ ë¸Œëœì¹˜ì˜ ì½”ë“œë¥¼ ê°€ì ¸ì˜¬ ê²ƒì¸ì§€ ì„¤ì •í•´ì¤„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì—¬ê¸°ì„œëŠ” master ë¸Œëœì¹˜ì˜ ì½”ë“œë¥¼ ê°€ì ¸ì˜¤ë„ë¡ í•˜ë„ë¡ ì„¤ì •í–ˆìŠµë‹ˆë‹¤.

![/static/media/react_s3_codebuild/Screen_Shot_2020-08-18_at_7.24.24_PM.png](/static/media/react_s3_codebuild/Screen_Shot_2020-08-18_at_7.24.24_PM.png)

### Primary source webhook events

Source ë¥¼ ê°œì¸ Github account ë¡œ ì„ íƒí•˜ê²Œ ë˜ë©´ ì•„ë˜ì™€ ê°™ì´ `Primary source webhook events` ë¥¼ ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì—¬ê¸°ì„œ webhook ì„ í™œìš©í•˜ì—¬ ì›í•˜ëŠ” ë¸Œëœì¹˜ì—ì„œ íŠ¹ì • ì´ë²¤íŠ¸ê°€ ë°œìƒí•  ë•Œ ë§ˆë‹¤ í”„ë¡œì íŠ¸ë¥¼ ë¹Œë“œí•  ìˆ˜ ìˆë„ë¡ ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì €ëŠ” master ë¸Œëœì¹˜ì—ì„œ ì´ë²¤íŠ¸ê°€ ë°œìƒí• ë•Œë§Œ ë¹Œë“œê°€ ë˜ë„ë¡ í•˜ê¸° ìœ„í•´ì„œ `HEAD_REF` ê°’ìœ¼ë¡œ `refs/heads/master` ë¥¼ ì£¼ì—ˆìŠµë‹ˆë‹¤. ë˜ master ë¸Œëœì¹˜ì— í‘¸ì‰¬ë¥¼ í•˜ê±°ë‚˜ PR ì´ merge ê°€ ë  ë•Œë§Œ ë¹Œë“œê°€ ë  ìˆ˜ ìˆë„ë¡ í•˜ê¸° ìœ„í•´ `Event type` ìœ¼ë¡œ `PUSH`, `PULL_REQUEST_MERGED` ë¥¼ ì£¼ì—ˆìŠµë‹ˆë‹¤.

![/static/media/react_s3_codebuild/Screen_Shot_2020-08-18_at_7.25.37_PM.png](/static/media/react_s3_codebuild/Screen_Shot_2020-08-18_at_7.25.37_PM.png)

### Environment

ë‹¤ìŒìœ¼ë¡œ í”„ë¡œì íŠ¸ë¥¼ ë¹Œë“œí•˜ê¸° ìœ„í•´ í”„ë¡œë¹„ì €ë‹ í•  í™˜ê²½ì„ ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë•Œ í”„ë¡œë¹„ì €ë‹ì— í™œìš©ë  ë„ì»¤ ì´ë¯¸ì§€ë¡œ AWS ì—ì„œ ì œê³µí•˜ëŠ” ì´ë¯¸ì§€ë¥¼ ì‚¬ìš©í•  ìˆ˜ë„ ìˆê³  Docker Hub ì— ì €ì¥ëœ ê°œì¸ì ì¸ ì´ë¯¸ì§€ë„ í™œìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì—¬ê¸°ì„  `Operation system` ì€ `Amazon Linux 2` ë¡œ ì„¤ì •í•´ì£¼ê³ , `Runtime` ì€ `Standard` ë¡œ, `Image` ëŠ” `aws/codebuild/amazonlinux2-aarch64-standard:2.0` ìœ¼ë¡œ ì„¤ì •í•´ì£¼ê³  `Image version` ì€ `Always use the latest image for this runtime version` ìœ¼ë¡œ ì„¤ì •í•´ ì£¼ê² ìŠµë‹ˆë‹¤.

![/static/media/react_s3_codebuild/Screen_Shot_2020-08-18_at_6.56.13_PM.png](/static/media/react_s3_codebuild/Screen_Shot_2020-08-18_at_6.56.13_PM.png)

ë˜ `Environment` ì—ì„œ `Service role` ì„ ì„ íƒí•  ìˆ˜ ìˆëŠ”ë°, ì—¬ê¸°ì„œ ì¡°ê¸ˆ ì „ì— ìƒì„±í•œ IAM Role ì„ ì„ íƒí•´ì£¼ë©´ ë©ë‹ˆë‹¤. ë¹Œë“œí•œ React ì•„í‹°íŒ©íŠ¸ë¥¼ S3 ì— ì˜¬ë ¤ì•¼ í•´ì„œ IAM Role ì´ í•„ìš”í•˜ê¸° ë•Œë¬¸ì´ì£ .

![/static/media/react_s3_codebuild/Screen_Shot_2020-08-18_at_6.57.11_PM.png](/static/media/react_s3_codebuild/Screen_Shot_2020-08-18_at_6.57.11_PM.png)

### Buildspec

ë§ˆì§€ë§‰ìœ¼ë¡œ CodeBuild ì—ê²Œ ì–´ë–¤ job ì„ ìˆ˜í–‰í•˜ë„ë¡ ëª…ì‹œí•˜ëŠ” ìŠ¤í™ íŒŒì¼ì„ ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì»¤ë§¨ë“œë¥¼ ì§ì ‘ ì…ë ¥í•  ìˆ˜ë„ ìˆì§€ë§Œ, ì—¬ê¸°ì„œëŠ” ìŠ¤í™ íŒŒì¼ì„ ì„¤ì •í•˜ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.

CodeBuild ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ í”„ë¡œì íŠ¸ root ë””ë ‰í† ë¦¬ì—ì„œ `buildspec.yml` ì´ë€ íŒŒì¼ì„ ìŠ¤í™ íŒŒì¼ë¡œ ì‚¬ìš©í•©ë‹ˆë‹¤. ê·¸ë ‡ê¸° ë•Œë¬¸ì— ë”°ë¡œ ìŠ¤í™ íŒŒì¼ ì´ë¦„ì„ ì •ì˜í•˜ì§€ ì•Šì•„ë„ ë˜ì§€ë§Œ, ì—¬ëŸ¬ í™˜ê²½ìœ¼ë¡œ ë¹Œë“œí•´ì•¼ í•  ê²½ìš° ìŠ¤í™ íŒŒì¼ì„ ë‹¤ë¥´ê²Œ ì •ì˜í•  ìˆ˜ë„ ìˆëŠ” ê±¸ ë³´ì—¬ë“œë¦¬ê¸° ìœ„í•´ ë‹¤ìŒê³¼ ê°™ì´ `buildspec.production.yml` ì´ë¼ê³  ìŠ¤í™ íŒŒì¼ ì´ë¦„ì„ ì •ì˜í•´ë³´ê² ìŠµë‹ˆë‹¤.

![/static/media/react_s3_codebuild/Screen_Shot_2020-08-18_at_7.01.47_PM.png](/static/media/react_s3_codebuild/Screen_Shot_2020-08-18_at_7.01.47_PM.png)

ì, ë©€ê³ ë„ ë©€ì—ˆë˜ CodeBuild ì„¤ì •ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ì´ì œ ë§¨ ì•„ë˜ `Create build project` ë²„íŠ¼ì„ í´ë¦­í•´ì„œ CodeBuild í”„ë¡œì íŠ¸ë¥¼ ìƒì„±í•´ì¤ì‹œë‹¤.

![/static/media/react_s3_codebuild/Screen_Shot_2020-08-18_at_7.02.07_PM.png](/static/media/react_s3_codebuild/Screen_Shot_2020-08-18_at_7.02.07_PM.png)

---

## 4. Add buildspec.yml in your React App

ê¸°ì¡´ì˜ ì¡´ì¬í•˜ëŠ” React App ë£¨íŠ¸ ë””ë ‰í„°ë¦¬ì— ì•„ë˜ `buildspec.production.yml` íŒŒì¼ì„ ì¶”ê°€í•´ì¤ì‹œë‹¤.

### buildspec.production.yml

```yaml
version: 0.1
phases:
  pre_build:
    commands:
      - echo Installing source NPM dependencies...
      - npm install
  build:
    commands:
      - echo Build started on `date`
      - npm run build
  post_build:
    commands:
      # copy the contents of /build to S3
      - aws s3 cp --recursive --acl public-read ./build s3://<YOUR_BUCKET_NAME>/

      # set the cache-control headers for service-worker.js to prevent
      # browser caching
      - >
        aws s3 cp --acl public-read 
        --cache-control="max-age=0, no-cache, no-store, must-revalidate" 
        ./build/service-worker.js s3://<YOUR_BUCKET_NAME>/

      # set the cache-control headers for index.html to prevent
      # browser caching
      - >
        aws s3 cp --acl public-read 
        --cache-control="max-age=0, no-cache, no-store, must-revalidate" 
        ./build/index.html s3://<YOUR_BUCKET_NAME>/
artifacts:
  files:
    - '**/*'
  base-directory: build
```

ìœ„ íŒŒì¼ì—ì„œ ì´ ì„¸ ê°€ì§€ phase(`pre_build`, `build`, `post_build`)ë¥¼ ì •ì˜í•˜ì˜€ìŠµë‹ˆë‹¤. CodeBuild ì—ì„œëŠ” í”„ë¡œì íŠ¸ë¥¼ ë¹Œë“œí•˜ëŠ” ë„ì¤‘ ì—¬ëŸ¬ phase ë¥¼ ê±°ì¹˜ê²Œ ë˜ëŠ”ë° ìì„¸í•œ ë‚´ìš©ì€ ì•„ë˜ [ê³µì‹ document](https://docs.aws.amazon.com/ko_kr/codebuild/latest/userguide/build-spec-ref.html) ë¥¼ ì°¸ê³ í•˜ë©´ ë©ë‹ˆë‹¤.

ê°„ë‹¨íˆ ì‚´í´ë³´ë©´ `pre_build` ì—ì„œ ë””íœë˜ì‹œë“¤ì„ ì„¤ì¹˜í•˜ê³ , `build` ì—ì„œ react ì•±ì„ ë¹Œë“œí•˜ë©°, `post_build` ì—ì„œ ë¹Œë“œëœ ì•„í‹°íŒ©íŠ¸ë¥¼ ì—…ë¡œë“œí•œ ë’¤ `service-worker.js` ì™€ `index.html` ì˜ cache-control í—¤ë”ë¥¼ ë³€ê²½í•´ì¤ë‹ˆë‹¤. ê·¸ë¦¬í•˜ì—¬ ë¹Œë“œí•œ íŒŒì¼ì´ S3 ì— ì˜¬ë¼ê°€ë©´ ì´ì „ì— ë¹Œë“œí•œ íŒŒì¼ì´ ìºì‹œë˜ì–´ ì „ë‹¬ë˜ì§€ ì•Šë„ë¡ í•´ì¤ë‹ˆë‹¤. ë§ˆì§€ë§‰ìœ¼ë¡œ `artifacts` ì—ì„œ codebuild ê°€ ë¹Œë“œí•œ íŒŒì¼ì„ í¬í•¨í•  ë””ë ‰í„°ë¦¬ë¥¼ ëª…ì‹œí•´ ì¤ë‹ˆë‹¤.

ì, ì´ë ‡ê²Œ ë¹Œë“œ ìŠ¤í™ íŒŒì¼ì„ Github remote repository ì— í‘¸ì‹œí•˜ë©´ CodeBuild ì— webhook ì´ ì „ë‹¬ë˜ì–´ ë¹Œë“œ íŒŒì´í”„ë¼ì¸ì´ ëŒì•„ê°€ê¸° ì‹œì‘í•  ê²ƒì…ë‹ˆë‹¤.

---

## 5. Deploy

[http://lovo-s3-codebuild.s3-website-us-west-2.amazonaws.com/](http://lovo-s3-codebuild.s3-website-us-west-2.amazonaws.com/)

AWS CodeBuild ì„œë¹„ìŠ¤ì— ë“¤ì–´ê°€ë³´ë©´ ì¡°ê¸ˆ ì „ ìƒì„±í•œ ë¹Œë“œ í”„ë¡œì íŠ¸ê°€ ëŒì•„ê°€ê³  ìˆëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤(Latest build status ê°€ `In progress` ë¡œ ë³€ê²½ë˜ì–´ ìˆìŒ). í•´ë‹¹ ë¹Œë“œ í”„ë¡œì íŠ¸ë¥¼ ì„ íƒí•˜ë©´ í˜„ì¬ê¹Œì§€ ì§„í–‰ëœ ë¹Œë“œ íˆìŠ¤í† ë¦¬ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

![/static/media/react_s3_codebuild/Screen_Shot_2020-08-18_at_7.30.25_PM.png](/static/media/react_s3_codebuild/Screen_Shot_2020-08-18_at_7.30.25_PM.png)

![/static/media/react_s3_codebuild/Screen_Shot_2020-08-18_at_7.30.43_PM.png](/static/media/react_s3_codebuild/Screen_Shot_2020-08-18_at_7.30.43_PM.png)

ë¹Œë“œ í”„ë¡œì íŠ¸ ìƒì„¸ í˜ì´ì§€ì—ì„œ í˜„ì¬ ë¹Œë“œê°€ ì–´ë–¤ phase ì— ìˆê³ , ë¡œê·¸ëŠ” ì–´ë–»ê²Œ ë‚˜ì˜¤ëŠ”ì§€ë„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

![/static/media/react_s3_codebuild/Screen_Shot_2020-08-18_at_7.31.31_PM.png](/static/media/react_s3_codebuild/Screen_Shot_2020-08-18_at_7.31.31_PM.png)

ë¹Œë“œê°€ ì„±ê³µì ìœ¼ë¡œ ì´ë¤„ì¡Œë‹¤ë©´ S3 ì£¼ì†Œì— ì ‘ì†í–ˆì„ ë•Œ ë‹¤ìŒê³¼ ê°™ì´ React App ì´ ì˜ í˜¸ìŠ¤íŒ… ëœ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

![/static/media/react_s3_codebuild/Screen_Shot_2020-08-18_at_7.37.48_PM.png](/static/media/react_s3_codebuild/Screen_Shot_2020-08-18_at_7.37.48_PM.png)

---

## Recap

ì§€ê¸ˆê¹Œì§€ Github ì— ì €ì¥ëœ React App ì„ AWS S3, IAM ê·¸ë¦¬ê³  CodeBuild ë¥¼ í™œìš©í•˜ì—¬ ë°°í¬í•˜ëŠ” CI/CD íŒŒì´í”„ë¼ì¸ êµ¬ì¶• ê³¼ì •ì„ ì •ë¦¬í•´ë³´ì•˜ìŠµë‹ˆë‹¤. ì—¬ê¸°ì„œëŠ” `buildspec.yml` íŒŒì¼ì— ë¹Œë“œí•œ íŒŒì¼ì„ S3 ì— ì—…ë¡œë“œ í•˜ëŠ” ì‘ì—…ë§Œì„ ë‹¤ë£¨ì—ˆì§€ë§Œ ì´ ë¿ë§Œ ì•„ë‹ˆë¼ í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì‹¤í–‰í•˜ëŠ” ê³¼ì •ë„ ì¶”ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë˜ëŠ” CloudFront ì™€ ì—°ë™í•˜ì—¬ ìºì‹œë¥¼ invalidate í•˜ëŠ” ë¡œì§ë„ ì¶”ê°€í•  ìˆ˜ ìˆì£ . AWS CodeBuildëŠ” AWS ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•˜ê³  ìˆë‹¤ë©´ ìœ ìš©í•˜ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ì¢‹ì€ ë„êµ¬ì¸ ê²ƒ ê°™ìŠµë‹ˆë‹¤ğŸ˜€.

## References

- [CodeBuildì˜ ë¹Œë“œ ì‚¬ì–‘ ì°¸ì¡°](https://docs.aws.amazon.com/ko_kr/codebuild/latest/userguide/build-spec-ref.html)

- [CodeBuildìš© GitHub pull ìš”ì²­ ë° Webhook í•„í„° ìƒ˜í”Œ](https://docs.aws.amazon.com/ko_kr/codebuild/latest/userguide/sample-github-pull-request.html)

- [ì›¹ ì‚¬ì´íŠ¸ ì—”ë“œí¬ì¸íŠ¸](https://docs.aws.amazon.com/ko_kr/AmazonS3/latest/dev/WebsiteEndpoints.html)

- [WebhookFilter](https://docs.aws.amazon.com/codebuild/latest/APIReference/API_WebhookFilter.html)
