---
title: KNN ì•Œê³ ë¦¬ì¦˜ìœ¼ë¡œ Regression í•˜ëŠ” ë°©ë²•
summary: KNN ì•Œê³ ë¦¬ì¦˜ìœ¼ë¡œ regression ë¬¸ì œë¥¼ í‘¸ëŠ” ë°©ë²•ì— ëŒ€í•´ì„œ ì•Œì•„ë´…ì‹œë‹¤
date: '2019-10-20T16:00:00.000Z'
draft: false
slug: 'how-to-regression-with-KNN'
category: Machine Learning
tags:
  - TIL
  - Machine Learning
  - Python
---

KNN ì•Œê³ ë¦¬ì¦˜ì€ classification ë¬¸ì œë¥¼ í‘¸ëŠ”ë° ìœ ìš©í•œ ì•Œê³ ë¦¬ì¦˜ì´ì§€ë§Œ, ë™ì‹œì— regression ë¬¸ì œë„ í’€ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œëŠ” ì €ë²ˆ KNN í¬ìŠ¤íŒ…ì—ì„œ ì‚¬ìš©í–ˆë˜ movie ë°ì´í„°ë¥¼ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•˜ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ìƒˆë¡œìš´ ì˜í™”ì˜ good ë˜ëŠ” bad ë¥¼ ë¶„ë¥˜í•˜ëŠ” ê²ƒì´ ì•„ë‹Œ, ì‹¤ì œ IMDb í‰ì ì„ ì˜ˆì¸¡í•´ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.

ê·¸ ê³¼ì •ì€ classification ì—ì„œì™€ ê±°ì˜ ë™ì¼í•˜ì§€ë§Œ, ë§ˆì§€ë§‰ ë‹¨ê²Œì—ì„œ ì´ì›ƒì˜ good, bad ìˆ˜ë¥¼ ì„¸ëŠ” ê²ƒì´ ì•„ë‹Œ ì´ì›ƒì˜ IMDb í‰ì ì˜ í‰ê· ì„ ê³„ì‚°í•©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ì„¸ ì´ì›ƒì˜ í‰ì ì´ `5.0`, `9.2`, `6.8` ì´ë¼ë©´ ìƒˆë¡œìš´ ì˜í™”ì˜ í‰ì ì€ `7.0` ìœ¼ë¡œ ì˜ˆì¸¡ë  ê²ƒì…ë‹ˆë‹¤.

# Weighted Regression

í‰ê· ì„ ê·¸ëƒ¥ ê³„ì‚°í•  ìˆ˜ë„ ìˆì§€ë§Œ, ì¢€ë” ìš°ì•„í•œ ë°©ë²•ìœ¼ë¡œ ê³„ì‚°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë°”ë¡œ ì´ì›ƒì´ ì–¼ë§ˆë‚˜ ê°€ê¹Œìš´ì§€ì— ë”°ë¼ì„œ _weighted_ average(ê°€ì¤‘ í‰ê· )ì„ ê³„ì‚°í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´ ì˜í™” Xì˜ í‰ì ì„ ì˜ˆì¸¡í•˜ê³ ì í•˜ëŠ”ë° ë‹¤ìŒê³¼ ê°™ì€ ì„¸ ì´ì›ƒ ì˜í™”ê°€ ìˆë‹¤ê³  ìƒê°í•´ë´…ì‹œë‹¤.

| ì˜í™” | í‰ì  | ì˜í™” X ì™€ì˜ ê±°ë¦¬ |
| ---- | ---- | ---------------- |
| A    | 5.0  | 3.2              |
| B    | 6.8  | 11.5             |
| C    | 9.0  | 1.1              |

ê·¸ëƒ¥ ì´ì›ƒ ì˜í™”ë“¤ì˜ í‰ì  í‰ê· ì„ ê³„ì‚°í•œë‹¤ë©´ 6.93ì´ ë  ê²ƒì…ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ì˜í™” XëŠ” ì˜í™” Cì™€ ê°€ê¹ê¸° ë•Œë¬¸ì—, Cì˜ í‰ì ì´ í‰ê· ì„ ê³„ì‚°í•  ë•Œ ë” ì¤‘ìš”í•˜ê²Œ ì‘ìš©í•˜ë©´ ì¢‹ì„ ê²ƒì…ë‹ˆë‹¤. Weighted averageë¡œ í‰ê· ì„ ê³„ì‚°í•œë‹¤ë©´ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.

$$\cfrac{ {5.0\over3.2} + {6.8\over11.5} + {9.0\over1.1} }{ {1\over3.2} + {1\over11.5} + {1\over1.1} } = 7.9$$

numerator(ë¶„ì)ëŠ” ê° ì˜í™”ì˜ í‰ì , ì¦‰ ì˜ˆì¸¡í•˜ê³ ì í•˜ëŠ” ê°’ì„ ê°ê° Xì™€ì˜ ê±°ë¦¬ë¡œ ë‚˜ëˆˆ ê°’ì˜ í•©ì…ë‹ˆë‹¤. denominator(ë¶„ëª¨)ëŠ” 1ì„ ê°ê° Xì™€ì˜ ê±°ë¦¬ë¡œ ë‚˜ëˆˆ ê°’ì˜ í•©ì…ë‹ˆë‹¤. í‰ì ì€ ì „í˜€ ë³€í•˜ì§€ ì•Šì•˜ì§€ë§Œ, ìƒˆë¡­ê²Œ ê³„ì‚°ëœ í‰ê· ê°’ì€ 7.9ê°€ ë˜ì—ˆìŠµë‹ˆë‹¤.

## Python code

ì´ì „ì—ëŠ” ì´ì›ƒì˜ classì— ë”°ë¼ unknown ë°ì´í„°ì˜ classë¥¼ ë¶„ë¥˜í•˜ëŠ” `.classify()` í•¨ìˆ˜ë¥¼ ì‘ì„±í•˜ì˜€ëŠ”ë°, ì´ë²ˆì—ëŠ” í‰ì ì„ ì˜ˆì¸¡í•˜ëŠ” `.predict()` í•¨ìˆ˜ë¥¼ ì‘ì„±í•´ë´…ì‹œë‹¤. í•œ ê°€ì§€ ì°¨ì´ì ì€ ì´ì „ì—” ë¼ë²¨ë¡œ movie_labelsë¼ëŠ” 0ê³¼ 1ë¡œ ë¶„ë¥˜ë˜ëŠ” ë°ì´í„°ë¥¼ í™œìš©í–ˆë‹¤ë©´ ì´ë²ˆì—ëŠ” movie_ratings ë¼ëŠ” í‰ì (ì‹¤ìˆ˜) ë°ì´í„°ë¥¼ í™œìš©í•©ë‹ˆë‹¤.

```python
from movies import movie_dataset, movie_ratings

def predict(unknown, dataset, movie_ratings, k):
  distances = []
  # datasetì˜ ëª¨ë“  ë°ì´í„°ë¥¼ ìˆœíšŒí•©ë‹ˆë‹¤
  for title in dataset:
    movie = dataset[title]
    # ê° ë°ì´í„°ì˜ unknownê³¼ì˜ ê±°ë¦¬ì™€ titleì„ distances ë°°ì—´ì— ì¶”ê°€í•©ë‹ˆë‹¤
    distances.append([distance(movie, unknown), title])
  distances.sort()	# ê±°ë¦¬ê°€ ê°€ê¹Œìš´ ìˆœìœ¼ë¡œ ì •ë ¬í•©ë‹ˆë‹¤

  neighbors = distances[0:k]	# ê°€ì¥ ê°€ê¹Œìš´ k ê°œì˜ ì´ì›ƒì„ êµ¬í•©ë‹ˆë‹¤
  numerator, denominator = [ 0, 0 ]

  for neighbor in neighbors:
    numerator += movie_ratings[neighbor[1]] / neighbor[0]
    denominator += 1 / neighbor[0]

  return numerator / denominator
```

# Scikit-Learn

ì—­ì‹œë‚˜ scikit-learnì—ì„œ ìœ„ì™€ ê°™ì´ regression ë¬¸ì œë¥¼ í’€ ìˆ˜ ìˆëŠ” KNN ì•Œê³ ë¦¬ì¦˜ì„ ì œê³µí•©ë‹ˆë‹¤. `KneighborsRegressor` ê°ì²´ë¥¼ í™œìš©í•˜ê³ , ì‚¬ìš© ë°©ë²•ì€ `KNeighborsClassifier` ê³¼ ë™ì¼í•©ë‹ˆë‹¤. ë¨¼ì € `sklearn` ì—ì„œ `neighbors` ë¥¼ ë¶ˆëŸ¬ì™€ `KneighborsRegressor` ë¥¼ ì„í¬íŠ¸í•©ë‹ˆë‹¤.

```python
from sklearn.neighbors import KNeighborsRegressor
```

ê·¸ëŸ° ë‹¤ìŒ regressor ê°ì²´ë¥¼ ìƒì„±í•´ì¤ì‹œë‹¤. ì´ ë•Œ `n_neighbors`(`k`) ë¥¼ ì§€ì •í•˜ê³ , `weights` ì˜µì…˜ì„ ì§€ì •í•´ì¤ë‹ˆë‹¤. ë§Œì•½ `weights` ì˜µì…˜ìœ¼ë¡œ `uniform` ì„ ì§€ì •í•´ ì£¼ë©´ í‰ê· ì„ ê³„ì‚°í•  ë•Œ ëª¨ë“  ì´ì›ƒì˜ ê°’ì´ ë™ë“±í•˜ê²Œ ë°˜ì˜ë©ë‹ˆë‹¤. ë°˜ë©´ `distance` ë¡œ ì§€ì •í•´ì£¼ë©´ í‰ê· ì„ ê³„ì‚°í•  ë•Œ ê°€ì¤‘ í‰ê· ìœ¼ë¡œ ê³„ì‚°í•©ë‹ˆë‹¤.

```python
regressor = KNeighborsRegressor(n_neighbors = 3, weights = "distance")
```

ë‹¤ìŒìœ¼ë¡œ `.fit()` í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ì—¬ ë°ì´í„°ë¥¼ í•™ìŠµì‹œí‚µë‹ˆë‹¤.

```python
training_points = [
  [0.5, 0.2, 0.1],
  [0.9, 0.7, 0.3],
  [0.4, 0.5, 0.7]
]

training_labels = [5.0, 6.8, 9.0]
regressor.fit(training_points, training_labels)
```

ë§ˆì§€ë§‰ìœ¼ë¡œ `.predict()` í•¨ìˆ˜ì— unknown ë°ì´í„°ë¥¼ ì „ë‹¬í•©ë‹ˆë‹¤.

```python
unknown_points = [
  [0.2, 0.1, 0.7],
  [0.4, 0.7, 0.6],
  [0.5, 0.8, 0.1]
]

guesses = regressor.predict(unknown_points)
```

ì´ì œ ìš°ë¦¬ì˜ ì˜í™” ë°ì´í„°ë¥¼ í™œìš©í•´ì„œ íŠ¹ì • ì˜í™”ì˜ í‰ì ì„ ì˜ˆì¸¡í•´ë³´ë„ë¡ í•©ì‹œë‹¤. ì´ ë•Œ `k` ëŠ” 5ë¡œ ì„¤ì •í•˜ê³ , í‰ê· ì€ ê°€ì¤‘í‰ê· ìœ¼ë¡œ ê³„ì‚°í•˜ë„ë¡ í•©ì‹œë‹¤.

```python
from movies import movie_dataset, movie_ratings
from sklearn.neighbors import KNeighborsRegressor

regressor = KNeighborsRegressor(n_neighbors=5, weights='distance')

regressor.fit(movie_dataset, movie_ratings)
# ì„¸ ì˜í™”ì˜ [ì •ê·œí™”ëœ íˆ¬ì… ì˜ˆì‚°, ëŸ¬ë‹ íƒ€ì„, ì œì‘ ì—°ë„] ë°ì´í„°ë¥¼ ì˜ˆì¸¡í•´ë´…ì‹œë‹¤
print(regressor.predict([
    [0.016, 0.300, 1.022],	# Incredibles 2
    [0.0004092981, 0.283, 1.0112], # The Big Sick
    [0.00687649, 0.235, 1.0112]	# Greatest Showman
]))
# [6.84913968 5.47572913 6.91067999]
```

# Review

ì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œëŠ” KNN ìœ¼ë¡œ regression ë¬¸ì œë¥¼ í‘¸ëŠ” ë°©ë²•ì— ëŒ€í•´ì„œ ê°„ë‹¨íˆ ì•Œì•„ë³´ì•˜ìŠµë‹ˆë‹¤. ì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œ ë°°ìš´ ë‚´ìš©ì„ ì •ë¦¬í•˜ë©´ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.

- The K-Nearest Neighbor algorithm can be used for regression. Rather than returning a classification, it returns a number.
- By using a weighted average, data points that are extremely similar to the input point will have more of a say in the final result.
- scikit-learn has an implementation of a K-Nearest Neighbor regressor named `KNeighborsRegressor`.

ë‹¤ìŒ í¬ìŠ¤íŒ…ì—ì„œëŠ” Logistic Regression ì— ëŒ€í•´ì„œ ì•Œì•„ë³´ë„ë¡ í•©ì‹œë‹¤ğŸ¥°

# References

- [Codecademy](http://www.codecademy.com)
