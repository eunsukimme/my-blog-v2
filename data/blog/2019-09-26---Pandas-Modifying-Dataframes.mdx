---
title: Pandasì—ì„œ columnë‹¤ë£¨ê¸°
summary: Pandasì—ì„œ ì»¬ëŸ¼ì„ ì¶”ê°€í•˜ê³ , ì»¬ëŸ¼ ìƒì—ì„œ ì—°ì‚°í•˜ê³ , ì»¬ëŸ¼ì— lambdaí•¨ìˆ˜ë¥¼ ì ìš©í•˜ë©° ì´ë¦„ì„ ë³€ê²½í•˜ëŠ” ë°©ë²•ì— ëŒ€í•´ì„œ ì•Œì•„ë´…ì‹œë‹¤
date: '2019-09-26T00:00:00.000Z'
draft: false
slug: 'handling-columns-with-pandas'
category: Data Science
tags:
  - TIL
  - Python
  - Data Science
  - Pandas
---

# ì»¬ëŸ¼ ì¶”ê°€í•˜ê¸°(Adding a Column)

ê¸°ì¡´ì— ì¡´ì¬í•˜ëŠ” *DataFrame*ì— column ì„ ì¶”ê°€í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´ ë‹¤ìŒê³¼ ê°™ì€ *DataFrame*ì´ ìˆë‹¤ê³  ê°€ì •í•´ ë´…ì‹œë‹¤.

| Product ID | Product Description | Cost to Manufacture | Price |
| ---------- | ------------------- | ------------------- | ----- |
| 1          | 3 inch screw        | 0.50                | 0.75  |
| 2          | 2 inch nail         | 0.10                | 0.25  |
| 3          | hammer              | 3.00                | 5.50  |
| 4          | screwdriver         | 2.50                | 3.00  |

ìœ„ *DataFrame*ì— ìˆ˜ëŸ‰ì„ ë‚˜íƒ€ë‚´ëŠ” Quantity í•„ë“œë¥¼ ì¶”ê°€í•˜ê³  ì‹¶ë‹¤ë©´ ë‹¤ìŒê³¼ ê°™ì´ ì½”ë“œë¥¼ ì‘ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì¶”ê°€í•˜ê³  ì‹¶ì€ í•„ë“œë¥¼ *DataFrame*ì˜ key ë¡œ í•˜ì—¬ ê°™ì€ ê¸¸ì´ì˜ ë°°ì—´ì„ í• ë‹¹í•´ ì£¼ë©´ ë©ë‹ˆë‹¤.

```python
df['Quantity'] = [100, 150, 50, 35]	# ìˆœì„œëŒ€ë¡œ 100, 150, 50, 35ê°€ í• ë‹¹ë©ë‹ˆë‹¤.
```

ëª¨ë“  ê°’ì„ ë™ì¼í•˜ê²Œ í• ë‹¹í•´ë„ ëœë‹¤ë©´ ë‹¤ìŒê³¼ ê°™ì´ ê°„ë‹¨í•˜ê²Œ ì‘ì„±í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.

```python
df['In Stock?'] = True	# ëª¨ë‘ Trueë¡œ í• ë‹¹ë©ë‹ˆë‹¤.
```

ë˜í•œ ê¸°ì¡´ì— ì¡´ì¬í•˜ëŠ” column ì„ í™œìš©í•˜ì—¬ ì—°ì‚°í•œ ê²°ê³¼ë¥¼ í• ë‹¹í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.

```python
df['Sales Tax'] = df.Price * 0.075	# ê° Priceì— 0.075ë¥¼ ê³±í•œ ê°’ì´ í• ë‹¹ë©ë‹ˆë‹¤.
```

# ì»¬ëŸ¼ ìƒì—ì„œ ì—°ì‚°í•˜ê¸°(Performing Column Operations)

ê³±ì…ˆê³¼ ê°™ì€ ë‹¨ìˆœí•œ ì—°ì‚° ì™¸ì—ë„ ê¸°ì¡´ì— ì¡´ì¬í•˜ëŠ” column ì„ í™œìš©í•˜ì—¬ ì—¬ëŸ¬ê°€ì§€ ì—°ì‚°ì„ ìˆ˜í–‰í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤. ë‹¤ìŒê³¼ ê°™ì€ *DataFrame*ì´ ìˆë‹¤ê³  ê°€ì •í•´ë´…ì‹œë‹¤.

| Name       | Email                                               |
| ---------- | --------------------------------------------------- |
| JOHN SMITH | [john.smith@gmail.com](mailto:john.smith@gmail.com) |
| Jane Doe   | [jdoe@yahoo.com](mailto:jdoe@yahoo.com)             |
| joe schmo  | [joeschmo@hotmail.com](mailto:joeschmo@hotmail.com) |

ìœ„ *DataFrame*ì—ì„œ Name ì†ì„±ì˜ ê°’ì˜ case ê°€ ì œê°ê°ì´ë¼ ì¡°ê¸ˆ annoying í•©ë‹ˆë‹¤. `apply` í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ë©´ íŠ¹ì • ì»¬ëŸ¼ì˜ ê°’ì— í•¨ìˆ˜ë¥¼ ì ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```python
df['Name'] = df.Name.apply(lambda name: name.upper())
```

ê²°ê³¼ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.

| Name       | Email                                               |
| ---------- | --------------------------------------------------- |
| JOHN SMITH | [john.smith@gmail.com](mailto:john.smith@gmail.com) |
| JANE DOE   | [jdoe@yahoo.com](mailto:jdoe@yahoo.com)             |
| JOE SCHMO  | [joeschmo@hotmail.com](mailto:joeschmo@hotmail.com) |

# ì»¬ëŸ¼ì— Lambda í•¨ìˆ˜ ì ìš©í•˜ê¸°(Applying a Lambda to a Column)

Pandas ë¥¼ í™œìš©í•  ë•Œ column ì— ëŒ€í•œ ì—°ì‚°ì„ ìˆ˜í–‰í•  ë•Œ Lambda ë¥¼ ë§ì´ í™œìš©í•˜ê²Œ ë©ë‹ˆë‹¤. ë‹¤ìŒê³¼ ê°™ì€ *DataFrame*ì´ ìˆë‹¤ê³  ê°€ì •í•´ ë´…ì‹œë‹¤.

| Name       | Email                                               |
| ---------- | --------------------------------------------------- |
| JOHN SMITH | [john.smith@gmail.com](mailto:john.smith@gmail.com) |
| Jane Doe   | [jdoe@yahoo.com](mailto:jdoe@yahoo.com)             |
| joe schmo  | [joeschmo@hotmail.com](mailto:joeschmo@hotmail.com) |

ìš°ë¦¬ëŠ” ì‚¬ìš©ìì˜ Email ì˜ Provider ë¥¼ ì¶”ì¶œí•˜ê¸° ìœ„í•´ ë‹¤ìŒê³¼ ê°™ì€ ì½”ë“œë¥¼ ì‘ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```python
df['Email Provider'] = df.Email.apply(
    lambda x: x.split('@')[-1]
  )
```

ê²°ê³¼ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.

| Name       | Email                                               | Email Provider |
| ---------- | --------------------------------------------------- | -------------- |
| JOHN SMITH | [john.smith@gmail.com](mailto:john.smith@gmail.com) | gmail.com      |
| Jane Doe   | [jdoe@yahoo.com](mailto:jdoe@yahoo.com)             | yahoo.com      |
| joe schmo  | [joeschmo@hotmail.com](mailto:joeschmo@hotmail.com) | hotmail.com    |

# ì—¬ëŸ¬ ì»¬ëŸ¼ì— Lambda í•¨ìˆ˜ ì ìš©í•˜ê¸°(Applying a Lambda to a Row)

ì§€ê¸ˆê¹Œì§„ `df.columnName.apply`ë¡œ íŠ¹ì • column ì— ëŒ€í•´ ì—°ì‚°ì„ ìˆ˜í–‰í–ˆëŠ”ë°, column ì„ ëª…ì‹œí•˜ì§€ ì•Šê³  `apply` í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ê³  `axis=1` ì˜µì…˜ì„ ë¶€ì—¬í•¨ìœ¼ë¡œì¨ lambda í•¨ìˆ˜ì˜ input ì„ ì „ì²´ row ë¡œ ì¤„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë‹¤ìŒê³¼ ê°™ì€ *DataFrame*ì´ ìˆë‹¤ê³  ê°€ì •í•´ ë´…ì‹œë‹¤.

| Item         | Price | Is taxed? |
| ------------ | ----- | --------- |
| Apple        | 1.00  | No        |
| Milk         | 4.20  | No        |
| Paper Towels | 5.00  | Yes       |
| Light Bulbs  | 3.75  | Yes       |

Is taxed? í•„ë“œì˜ ê°’ì´ 'Yes'ì¸ row ì— ëŒ€í•´ì„œ 7.5% ë¥¼ ë”í•œ ê°€ê²©ì„ ìƒˆ ì»¬ëŸ¼ 'Price with Tax'ì— ì¶”ê°€í•˜ê³  ì‹¶ë‹¤ê³  ìƒê°í•´ ë´…ì‹œë‹¤. ì½”ë“œëŠ” ë‹¤ìŒê³¼ ê°™ì´ ì‘ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```python
df['Price with Tax'] = df.apply(lambda row:
     row['Price'] * 1.075
     if row['Is taxed?'] == 'Yes'
     else row['Price'],
     axis=1
)
```

# ì»¬ëŸ¼ ì´ë¦„ ë³€ê²½í•˜ê¸°(Renaming Columns)

Column ì˜ ì´ë¦„ì„ ë³€ê²½í•˜ê³  ì‹¶ë‹¤ë©´ *DataFrame*ì˜ `.columns` ì†ì„±ì„ ì°¸ì¡°í•˜ì—¬ ë³€ê²½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì½”ë“œëŠ” ë‹¤ìŒê³¼ ê°™ì´ ì‘ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```python
df = pd.DataFrame({
    'name': ['John', 'Jane', 'Sue', 'Fred'],
    'age': [23, 29, 21, 18]
})
df.columns = ['First Name', 'Age']
```

ìœ„ ë°©ë²•ì€ ëª¨ë“  column ì˜ ì´ë¦„ì„ ìƒˆë¡œ ì„¤ì •í•  ë•Œ ìœ ìš©í•©ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ íŠ¹ì • column ì˜ ì´ë¦„ë§Œ ë³€ê²½í•˜ê³  ì‹¶ë‹¤ë©´ ìœ„ ë°©ë²•ì€ ì‹¤ìˆ˜ë¥¼ ìœ ë°œí•˜ê¸° ì‰¬ìš°ë¯€ë¡œ ë‹¤ìŒê³¼ ê°™ì´ `.rename` í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.

```python
df = pd.DataFrame({
    'name': ['John', 'Jane', 'Sue', 'Fred'],
    'age': [23, 29, 21, 18]
})
df.rename(columns={
    'name': 'First Name',
    'age': 'Age'},
    inplace=True)
```

`rename` í•¨ìˆ˜ëŠ” ì›ë³¸ *DataFrame*ì„ ê·¸ëŒ€ë¡œ ë‘” ì±„ ìƒˆë¡œìš´ *DataFrame*ì„ ë°˜í™˜í•˜ê¸°ì—, `inplace=True` ì˜µì…˜ì„ ë¶€ì—¬í•¨ìœ¼ë¡œì¨ ìƒˆë¡œìš´ *DataFrame*ì„ ë§Œë“¤ì§€ ì•Šê³  ì›ë³¸ *DataFrame*ì„ ìˆ˜ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

# Review

ì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œëŠ” ê¸°ì¡´ì— ì¡´ì¬í•˜ëŠ” *DataFrame*ì„ ìˆ˜ì •í•˜ëŠ” ë°©ë²•ì— ëŒ€í•´ì„œ ì•Œì•„ë³´ì•˜ìŠµë‹ˆë‹¤. ë°°ìš´ ë‚´ìš©ì„ ì •ë¦¬í•˜ë©´ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.

- Adding columns to a DataFrame
- Using lambda functions to calculate complex quantities
- Renaming columns

ê³„ì†í•´ì„œ ê³µë¶€ë¥¼ í•©ì‹œë‹¤!ğŸ”¥

# References

- [Codecademy](http://www.codecademy.com)
