---
title: Pandasì—ì„œ ì—¬ëŸ¬ DataFrameë‹¤ë£¨ê¸°
summary: Pandasë¡œ ì—¬ëŸ¬ DataFrameì„ mergeí•˜ëŠ” ë°©ë²•ì— ëŒ€í•´ì„œ ì•Œì•„ë´…ì‹œë‹¤
date: '2019-10-10T00:00:00.000Z'
draft: false
slug: 'handling-multiple-dataframes-in-pandas'
category: Data Science
tags:
  - TIL
  - Python
  - Data Science
  - Pandas
---

ì§€ê¸ˆê¹Œì§€ëŠ” í•˜ë‚˜ì˜ *DataFrame*ì„ ë‹¤ë£¨ëŠ” ë°©ë²•ë“¤ì— ëŒ€í•´ì„œ ì•Œì•„ë³´ì•˜ìŠµë‹ˆë‹¤. ê·¸ëŸ°ë° ëª¨ë“  ë°ì´í„°ë¥¼ í•˜ë‚˜ì˜ í…Œì´ë¸”ì— ì €ì¥í•˜ëŠ” ê²½ìš°ëŠ” í˜„ì‹¤ì—ì„  ì¢€ ì²˜ëŸ¼ ì‰½ê²Œ ì ‘í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë¯€ë¡œ ì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œëŠ” ì—¬ëŸ¬ í…Œì´ë¸”, ì¦‰ *DataFrame*ë“¤ì„ ë‹¤ë£¨ëŠ” ë°©ë²•ì— ëŒ€í•´ì„œ ì•Œì•„ë³´ë„ë¡ í•©ì‹œë‹¤.

# Inner Merge

Pandas ì—ì„œëŠ” ì—¬ëŸ¬ *DataFrame*ì„ ì—°ê²°ì§“ëŠ” Merge ë¼ëŠ” ê°œë…ì´ ì¡´ì¬í•©ë‹ˆë‹¤. Merge ëŠ” SQL ì˜ join ê³¼ ê°™ì€ ì›ë¦¬ë¡œ ë™ì‘í•©ë‹ˆë‹¤.

ì´í•´ë¥¼ ë•ê¸° ìœ„í•´ ìš°ë¦¬ê°€ e-Commerce ë¹„ì¦ˆë‹ˆìŠ¤ë¥¼ ìš´ì˜í•œë‹¤ê³  ìƒê°í•´ë´…ì‹œë‹¤. ìš°ë¦¬ ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ë‹¤ìŒê³¼ ê°™ì€ í…Œì´ë¸”ë“¤ì„ ì €ì¥í•œë‹¤ê³  ê°€ì •í•´ë´…ì‹œë‹¤.

- `orders` - ê° ì£¼ë¬¸ë“¤ì„ ì €ì¥í•˜ëŠ” í…Œì´ë¸”

  | order_id | customer_id | product_id | quantity | timestamp  |
  | -------- | ----------- | ---------- | -------- | ---------- |
  | 1        | 2           | 3          | 1        | 2017-01-01 |
  | 2        | 2           | 2          | 3        | 2017-01-01 |
  | 3        | 3           | 1          | 1        | 2017-01-01 |
  | 4        | 3           | 2          | 2        | 2017-02-01 |
  | 5        | 3           | 3          | 3        | 2017-02-01 |
  | 6        | 1           | 4          | 2        | 2017-03-01 |
  | 7        | 1           | 1          | 1        | 2017-02-02 |
  | 8        | 1           | 4          | 1        | 2017-02-02 |

- `products` - ìƒí’ˆ ì •ë³´ë¥¼ ì €ì¥í•˜ëŠ” í…Œì´ë¸”

  | product_id | description        | price |
  | ---------- | ------------------ | ----- |
  | 1          | thing-a-ma-jig     | 5     |
  | 2          | whatcha-ma-call-it | 10    |
  | 3          | doo-hickey         | 7     |
  | 4          | gizmo              | 3     |

- `customers` - ì‚¬ìš©ì ì •ë³´ë¥¼ ì €ì¥í•˜ëŠ” í…Œì´ë¸”

  | customer_id | customer_name | address       | phone_number |
  | ----------- | ------------- | ------------- | ------------ |
  | 1           | John Smith    | 123 Main St.  | 212-123-4567 |
  | 2           | Jane Doe      | 456 Park Ave. | 949-867-5309 |
  | 3           | Joe Schmo     | 798 Broadway  | 112-358-1321 |

ìœ„ì˜ `orders` í…Œì´ë¸”ì€ ì¢€ì²˜ëŸ¼ ì´í•´í•˜ê¸°ê°€ ì‰½ì§€ ì•ŠìŠµë‹ˆë‹¤. ì£¼ë¬¸ì„ í•œ ì‚¬ìš©ìì˜ ì •ë³´ë¥¼ ê°™ì´ í™•ì¸í•˜ê³  ì‹¶ì€ë°, ì‚¬ìš©ìì˜ ì •ë³´ë¥¼ í•¨ê»˜ ë‚˜íƒ€ë‚´ ì£¼ë©´ ì¢‹ì„ ê²ƒ ê°™ìŠµë‹ˆë‹¤. ì´ ë•Œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ”ê²Œ ë°”ë¡œ Merge ì…ë‹ˆë‹¤.

Pandas ì—ì„œëŠ” `.merge()` ë¼ëŠ” ë‘ *DataFrame*ì„ ì—®ì–´ì£¼ëŠ” ë©”ì„œë“œë¥¼ ì œê³µí•©ë‹ˆë‹¤. `.merge()` í•¨ìˆ˜ëŠ” ë‘ *DataFrame*ì˜ ê³µí†µëœ column ì„ ì°¾ì•„ë‚¸ ë’¤ ê° column ì˜ ê°’ì´ ë™ì¼í•œ row ë“¤ì„ ì°¾ì•„ëƒ…ë‹ˆë‹¤. ê·¸ëŸ° ë‹¤ìŒ ë§¤ì¹­ëœ row ë“¤ì„ í¬í•¨í•˜ëŠ” í•˜ë‚˜ì˜ row ë¥¼ ë§Œë“¤ì–´ ìƒˆë¡œìš´ *DataFrame*ì— ì¶”ê°€í•œ í›„ ì´ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.

```python
new_df = pd.merge(orders, customers)
```

ìœ„ ì½”ë“œëŠ” `orders` í…Œì´ë¸”ê³¼ `customers` í…Œì´ë¸”ì˜ ê³µí†µëœ column ì¸ `customer_id` ì˜ ê°’ì´ ì¼ì¹˜í•˜ëŠ” ëª¨ë“  row ë¥¼ ì°¾ì•„ëƒ…ë‹ˆë‹¤. ì¦‰, ì‚¬ìš©ìë“¤ì´ ì£¼ë¬¸í•œ ì£¼ë¬¸ë‚´ì—­ì„ í™•ì¸í•  ìˆ˜ ìˆê²Œë©ë‹ˆë‹¤.

Pandas ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ì œê³µí•˜ëŠ” `.merge()` ë¿ ë§Œ ì•„ë‹ˆë¼ *DataFrame*ë„ ê³ ìœ í•œ `.merge()` í•¨ìˆ˜ë¥¼ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´ ìœ„ì—ì„œ ì‘ì„±í•œ ì½”ë“œëŠ” ë‹¤ìŒê³¼ ê°™ì´ ì“¸ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.

```python
new_df = orders.merge(customers)	# pd.merge(orders, customers) ì™€ ë™ì¼í•©ë‹ˆë‹¤.
```

ë‘˜ì€ ì™„ì „íˆ ë™ì¼í•œ ê¸°ëŠ¥ì„ í•˜ì§€ë§Œ, ë‘ ê°œ ì´ìƒì˜ *DataFrame*ì„ merge í•˜ëŠ” ê²½ìš° 'chain'ì„ ì´ë£° ìˆ˜ ìˆê¸° ë•Œë¬¸ì— *DataFrame*ì˜ `.merge()` ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.

```python
big_df = orders.merge(customers).merge(products)
```

# Merge on Specific Columns

Merge ëŠ” ë™ì¼í•œ column ì— ëŒ€í•´ì„œ ì´ë¤„ì§€ê¸° ë•Œë¬¸ì— ìœ„ì˜ ì˜ˆì—ì„œëŠ” ë³„ ë¬¸ì œì—†ì´ ì´ë¤„ì¡ŒìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ìš°ë¦¬ ì„œë¹„ìŠ¤ì˜ ë°ì´í„°ë² ì´ìŠ¤ í…Œì´ë¸”ì´ ë‹¤ìŒê³¼ ê°™ì´ ì´ë¤„ì ¸ìˆë‹¤ê³  ê°€ì •í•´ë´…ì‹œë‹¤.

- `customers`

  | id  | customer_name | address       | phone_number |
  | --- | ------------- | ------------- | ------------ |
  | 1   | John Smith    | 123 Main St.  | 212-123-4567 |
  | 2   | Jane Doe      | 456 Park Ave. | 949-867-5309 |
  | 3   | Joe Schmo     | 798 Broadway  | 112-358-1321 |

- `orders`

  | id  | customer_id | product_id | quantity | timestamp  |
  | --- | ----------- | ---------- | -------- | ---------- |
  | 1   | 2           | 3          | 1        | 2017-01-01 |
  | 2   | 2           | 2          | 3        | 2017-01-01 |
  | 3   | 3           | 1          | 1        | 2017-01-01 |
  | 4   | 3           | 2          | 2        | 2017-02-01 |
  | 5   | 3           | 3          | 3        | 2017-02-01 |
  | 6   | 1           | 4          | 2        | 2017-03-01 |
  | 7   | 1           | 1          | 1        | 2017-02-02 |
  | 8   | 1           | 4          | 1        | 2017-02-02 |

ë§Œì•½ ê·¸ëƒ¥ merge ë¥¼ í•˜ê²Œ ë˜ë©´ ì–´ë–»ê²Œ ë ê¹Œìš”? ë‘ í…Œì´ë¸” ëª¨ë‘ ë™ì¼í•œ `id`column ì„ ë³´ìœ í•˜ê¸° ë•Œë¬¸ì— `id`ê°€ ê°™ì€ ê²ƒë“¤ë¼ë¦¬ merge ê°€ ë˜ê² ì§€ë§Œ, ê°ê°ì˜ `id` ëŠ” ì˜ë¯¸í•˜ëŠ” ë°”ê°€ ë‹¬ë¼ì„œ ì˜ëª»ëœ ê²°ê³¼ë¥¼ ë§Œë“¤ì–´ ë‚¼ ê²ƒì…ë‹ˆë‹¤.

ì´ë¥¼ í•´ê²°í•  ìˆ˜ ìˆëŠ” í•œ ê°€ì§€ ë°©ë²•ì€ `.rename()` í•¨ìˆ˜ë¥¼ í™œìš©í•˜ì—¬ merge í•˜ëŠ” í…Œì´ë¸”ì˜ column ì´ë¦„ì„ ìˆ˜ì •í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ì¦‰, `customers` í…Œì´ë¸”ì˜ `id` column ì„ `customer_id` ë¡œ ìˆ˜ì •í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ê·¸ë¦¬í•˜ì—¬ `customer_id` ê°€ ê°™ì€ row ë¥¼ ë§¤ì¹­í•´ì¤„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```python
pd.merge(orders, customers.rename(column={'id': 'customer_id'}))
```

ë˜ ë‹¤ë¥¸ ë°©ë²•ì€ merge ì‹œí‚¤ê³ ì í•˜ëŠ” column ì„ ì •í•´ì£¼ëŠ” ê²ƒì…ë‹ˆë‹¤. `left_on` ê³¼ `right_on` ì˜µì…˜ì„ ë¶€ì—¬í•¨ìœ¼ë¡œì¨ ê° í…Œì´ë¸”ì˜ ì–´ë–¤ column ì„ ê¸°ì¤€ìœ¼ë¡œ merge í•  ê²ƒì¸ì§€ ì •í•´ì¤„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```python
# left í…Œì´ë¸”ì€ ë¨¼ì € ì£¼ì–´ì§„ orders ì…ë‹ˆë‹¤.
# right í…Œì´ë¸”ì€ ë‚˜ì¤‘ì— ì£¼ì–´ì§„ customers ì…ë‹ˆë‹¤.
# orders.customer_id ì™€ customers.id ê°€ ê°™ì€ rowë¥¼ ì°¾ìŠµë‹ˆë‹¤.
pd.merge(
	orders,
	customers,
	left_on='customer_id',
	right_on='id')
```

ë§Œì•½ ì´ë ‡ê²Œ merge í•˜ê²Œ ëœë‹¤ë©´ `order` ì˜ `id` column ê³¼ `customers` ì˜ `id` column ì´ í•¨ê»˜ merge ë˜ê¸° ë•Œë¬¸ì— í•œ row ì— ë‘ ê°œì˜ `id` columns ì´ ì¡´ì¬í•˜ê²Œ ë©ë‹ˆë‹¤. Pandas ëŠ” ì´ëŸ¬í•œ ë¬¸ì œë¥¼ ìì²´ì ìœ¼ë¡œ `id_x` , `id_y` ì™€ ê°™ì€ suffix ë¥¼ ì¶”ê°€í•¨ìœ¼ë¡œì¨ í•´ê²°í•´ì¤ë‹ˆë‹¤. ì¦‰ merge ê²°ê³¼ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.

| id_x | customer_id | product_id | quantity | timestamp           | id_y | customer_name | address      | phone_number |
| ---- | ----------- | ---------- | -------- | ------------------- | ---- | ------------- | ------------ | ------------ |
| 1    | 2           | 3          | 1        | 2017-01-01 00:00:00 | 2    | Jane Doe      | 456 Park Ave | 949-867-5309 |
| 2    | 2           | 2          | 3        | 2017-01-01 00:00:00 | 2    | Jane Doe      | 456 Park Ave | 949-867-5309 |
| 3    | 3           | 1          | 1        | 2017-01-01 00:00:00 | 3    | Joe Schmo     | 789 Broadway | 112-358-1321 |
| 4    | 3           | 2          | 2        | 2016-02-01 00:00:00 | 3    | Joe Schmo     | 789 Broadway | 112-358-1321 |
| 5    | 3           | 3          | 3        | 2017-02-01 00:00:00 | 3    | Joe Schmo     | 789 Broadway | 112-358-1321 |
| 6    | 1           | 4          | 2        | 2017-03-01 00:00:00 | 1    | John Smith    | 123 Main St. | 212-123-4567 |
| 7    | 1           | 1          | 1        | 2017-02-02 00:00:00 | 1    | John Smith    | 123 Main St. | 212-123-4567 |
| 8    | 1           | 4          | 1        | 2017-02-02 00:00:00 | 1    | John Smith    | 123 Main St. | 212-123-4567 |

Pandas ì—ì„œ column ì´ë¦„ì˜ ì¶©ëŒì„ í”¼í•˜ê²Œ í•´ì¤€ê²ƒì€ ê³ ë§™ì§€ë§Œ, `id_x` ì™€ `id_y` ëŠ” ì´í•´í•˜ëŠ”ë° ì „í˜€ ë„ì›€ì´ ë˜ì§€ ëª»í•©ë‹ˆë‹¤. ì´ë¥¼ í•´ê²°í•˜ë ¤ë©´ `.merge()` í•¨ìˆ˜ì— `suffixes` ì˜µì…˜ì„ ì œê³µí•˜ì—¬ x, y ëŒ€ì‹  ë‹¤ë¥¸ suffixes ë¥¼ í• ë‹¹í•˜ë„ë¡ í•´ì¤ë‹ˆë‹¤.

```python
# suffixes ì˜µì…˜ìœ¼ë¡œ ì¶©ëŒí•˜ëŠ” columnì— ë”í•  suffix ë°°ì—´ì„ ì „ë‹¬í•©ë‹ˆë‹¤.
pd.merge(
	orders,
	customers,
	left_on='customer_id',
	right_on='id',
	suffixes=['_order', '_customer']
)
```

ê·¸ëŸ¬ë©´ ê²°ê³¼ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.

| id_order | customer_id | product_id | quantity | timestamp           | id_customer | customer_name | address      | phone_number |
| -------- | ----------- | ---------- | -------- | ------------------- | ----------- | ------------- | ------------ | ------------ |
| 1        | 2           | 3          | 1        | 2017-01-01 00:00:00 | 2           | Jane Doe      | 456 Park Ave | 949-867-5309 |
| 2        | 2           | 2          | 3        | 2017-01-01 00:00:00 | 2           | Jane Doe      | 456 Park Ave | 949-867-5309 |
| 3        | 3           | 1          | 1        | 2017-01-01 00:00:00 | 3           | Joe Schmo     | 789 Broadway | 112-358-1321 |
| 4        | 3           | 2          | 2        | 2016-02-01 00:00:00 | 3           | Joe Schmo     | 789 Broadway | 112-358-1321 |
| 5        | 3           | 3          | 3        | 2017-02-01 00:00:00 | 3           | Joe Schmo     | 789 Broadway | 112-358-1321 |
| 6        | 1           | 4          | 2        | 2017-03-01 00:00:00 | 1           | John Smith    | 123 Main St. | 212-123-4567 |
| 7        | 1           | 1          | 1        | 2017-02-02 00:00:00 | 1           | John Smith    | 123 Main St. | 212-123-4567 |
| 8        | 1           | 4          | 1        | 2017-02-02 00:00:00 | 1           | John Smith    | 123 Main St. | 212-123-4567 |

# Outer Merge

ì§€ê¸ˆê¹Œì§€ëŠ” ë‘ í…Œì´ë¸” ëª¨ë‘ ë™ì¼í•œ column ì— ëŒ€í•´ ë§¤ì¹­ë˜ëŠ” ê°’ì´ í•­ìƒ ì¡´ì¬í•œ ê²½ìš°ë¥¼ ë‹¤ë¤„ë³´ì•˜ìŠµë‹ˆë‹¤. ê·¸ëŸ°ë° ë§Œì•½ ë™ì¼í•œ column ì— ëŒ€í•´ í•œ ìª½ í…Œì´ë¸”ì—ëŠ” ê°’ì´ ìˆëŠ”ë°, ë‹¤ë¥¸ ìª½ í…Œì´ë¸”ì—ëŠ” ê°’ì´ ì¡´ì¬í•˜ì§€ ì•ŠëŠ”ë‹¤ë©´ ì–´ë–»ê²Œ ë ê¹Œìš”? ì´ëŸ¬í•œ ê²½ìš° ë§¤ì¹˜ê°€ ë˜ì§€ ì•Šì•„ í•´ë‹¹ row ë¥¼ ìƒê²Œ ë©ë‹ˆë‹¤. ì´ëŸ¬í•œ merge ë¥¼ *inner merge*ë¼ê³  í•©ë‹ˆë‹¤. ë§¤ì¹­ë˜ì§€ ì•ŠëŠ” row ê°€ ì—†ë„ë¡ í•˜ë ¤ë©´ ë‹¤ë¥¸ íƒ€ì…ì˜ merge ë¥¼ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤.

ì´í•´ë¥¼ ë•ê¸° ìœ„í•´ Company A, Company B ë¼ëŠ” ë‘ íšŒì‚¬ê°€ ìˆë‹¤ê³  ìƒê°í•´ ë´…ì‹œë‹¤. A íšŒì‚¬ëŠ” ê³ ê° ì •ë³´ë¥¼ ìˆ˜ì§‘í•  ë•Œ name ê³¼ emai l ì •ë³´ë¥¼ ìˆ˜ì§‘í•˜ê³ , B íšŒì‚¬ëŠ” name ê³¼ phone ì •ë³´ë¥¼ ìˆ˜ì§‘í•©ë‹ˆë‹¤. ë‘ íšŒì‚¬ëŠ” ê°™ì€ ê³ ê°ì„ ë³´ìœ í•˜ê¸°ë„ í•˜ëŠ”ë°ìš”, ê° íšŒì‚¬ì˜ ê³ ê° ì •ë³´ í…Œì´ë¸”ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.

- `company_a`

  | name          | email                                                     |
  | ------------- | --------------------------------------------------------- |
  | Sally Sparrow | [sally.sparrow@gmail.com](mailto:sally.sparrow@gmail.com) |
  | Peter Grant   | [pgrant@yahoo.com](mailto:pgrant@yahoo.com)               |
  | Leslie May    | [leslie_may@gmail.com](mailto:leslie_may@gmail.com)       |

- `company_b`

  | name        | phone        |
  | ----------- | ------------ |
  | Peter Grant | 212-345-6789 |
  | Leslie May  | 626-987-6543 |
  | Aaron Burr  | 303-456-7891 |

ë‘ í…Œì´ë¸”ì„ inner merge í•˜ê²Œ ë˜ë©´ Peter Grant ì™€ Lesile May ì˜ ì •ë³´ë§Œì´ ë‚¨ê²Œ ë©ë‹ˆë‹¤. Sally Sparrow ëŠ” A íšŒì‚¬ì˜ í…Œì´ë¸”ì— ì €ì¥ë˜ì–´ìˆì§€ë§Œ B íšŒì‚¬ì— ì—†ê³ , Aaron Burr ëŠ” B íšŒì‚¬ì˜ í…Œì´ë¸”ì— ì €ì¥ë˜ì–´ìˆì§€ë§Œ A íšŒì‚¬ì— ì—†ì–´ì„œ ë§¤ì¹­ë˜ì§€ ì•Šê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.

ë§Œì•½ ê³ ê° ì •ë³´ì˜ ì†ì‹¤ì´ ì—†ì´ merge ë¥¼ í•˜ê³ ì í•œë‹¤ë©´ *Outer Merge*ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. *Outer Merge*ëŠ” ë¹„ë¡ ë§¤ì¹­ë˜ëŠ” row ê°€ ì—†ë”ë¼ë„ ë‘ í…Œì´ë¸”ì˜ ëª¨ë“  row ë¥¼ í¬í•¨ì‹œí‚µë‹ˆë‹¤. ì´ ë•Œ ë§¤ì¹­ë˜ì§€ ì•Šì€ row ì˜ ë‹¤ë¥¸ column ì€ `None` ë˜ëŠ” `nan` ìœ¼ë¡œ ì±„ì›Œì§‘ë‹ˆë‹¤. Merge í˜•íƒœëŠ” `how` ì˜µì…˜ì„ ë¶€ì—¬í•¨ìœ¼ë¡œì¨ ì§€ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```python
pd.merge(company_a, company_b, how='outer')
```

ìœ„ ì½”ë“œì˜ ê²°ê³¼ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.

| name          | email                                                     | phone        |
| ------------- | --------------------------------------------------------- | ------------ |
| Sally Sparrow | [sally.sparrow@gmail.com](mailto:sally.sparrow@gmail.com) | `nan`        |
| Peter Grant   | [pgrant@yahoo.com](mailto:pgrant@yahoo.com)               | 212-345-6789 |
| Leslie May    | [leslie_may@gmail.com](mailto:leslie_may@gmail.com)       | 626-987-6543 |
| Aaron Burr    | `nan`                                                     | 303-456-7891 |

# Left and Right Merge

ìœ„ì—ì„œ ì œì‹œí•œ A, B íšŒì‚¬ ì˜ˆë¥¼ ê·¸ëŒ€ë¡œ ê°€ì ¸ì™€ ë´…ì‹œë‹¤.

## Left Merge

ë§Œì•½ ê³ ê°ë“¤ ì¤‘ì—ì„œ phone ì •ë³´ê°€ ë¹ ì§„ ê³ ê°ì„ ì°¾ì•„ë‚´ê³  ì‹¶ë‹¤ê³  ê°€ì •í•´ë´…ì‹œë‹¤. ì´ ê²½ìš° *Left Merge*ë¥¼ í™œìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. *Left Merge*ëŠ” ì™¼ìª½ í…Œì´ë¸”ì˜ ëª¨ë“  row ë¥¼ í¬í•¨í•˜ì§€ë§Œ ì˜¤ë¥¸ìª½ í…Œì´ë¸”ì—ì„  ë§¤ì¹­ë˜ëŠ” row ë§Œì„ í¬í•¨í•©ë‹ˆë‹¤. `.merge()` í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•  ë•Œ ì²˜ìŒ ì£¼ì–´ì§€ëŠ” *DataFrame*ì´ ì™¼ìª½ í…Œì´ë¸”ì´ ë˜ê³ , ë‚˜ì¤‘ì— ì£¼ì–´ì§€ëŠ” *DataFrame*ì´ ì˜¤ë¥¸ìª½ í…Œì´ë¸”ì´ ë©ë‹ˆë‹¤.

```python
# company_aë¥¼ ë¨¼ì € ì œê³µí•¨ìœ¼ë¡œì¨, company_aì˜ ëª¨ë“  rowê°€ í¬í•¨ë©ë‹ˆë‹¤.
# company_bë¥¼ ë‚˜ì¤‘ì— ì œê³µí•¨ìœ¼ë¡œì¨, company_bëŠ” ë§¤ì¹­ë˜ëŠ” rowë§Œ í¬í•¨ë©ë‹ˆë‹¤.
pd.merge(company_a, company_b, how='left')
```

ìœ„ ì½”ë“œì˜ ê²°ê³¼ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.

| name          | email                                                     | phone        |
| ------------- | --------------------------------------------------------- | ------------ |
| Sally Sparrow | [sally.sparrow@gmail.com](mailto:sally.sparrow@gmail.com) | `None`       |
| Peter Grant   | [pgrant@yahoo.com](mailto:pgrant@yahoo.com)               | 212-345-6789 |
| Leslie May    | [leslie_may@gmail.com](mailto:leslie_may@gmail.com)       | 626-987-6543 |

## Right Merge

*Right Merge*ëŠ” *Left Merge*ì˜ ë°˜ëŒ€ì…ë‹ˆë‹¤. ì¦‰ ì˜¤ë¥¸ìª½ í…Œì´ë¸”ì˜ ëª¨ë“  row ë¥¼ í¬í•¨í•˜ì§€ë§Œ ì™¼ìª½ í…Œì´ë¸”ì—ì„  ë§¤ì¹­ë˜ëŠ” row ë§Œì„ í¬í•¨í•©ë‹ˆë‹¤.

```python
# company_aë¥¼ ë¨¼ì € ì œê³µí•¨ìœ¼ë¡œì¨, company_aëŠ” ë§¤ì¹­ë˜ëŠ” rowë§Œ í¬í•¨ë©ë‹ˆë‹¤.
# company_bë¥¼ ë‚˜ì¤‘ì— ì œê³µí•¨ìœ¼ë¡œì¨, company_bì˜ ëª¨ë“  rowê°€ í¬í•¨ë©ë‹ˆë‹¤.
pd.merge(company_a, company_b, how='right')
```

ìœ„ ì½”ë“œì˜ ê²°ê³¼ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.

| name        | email                                               | phone        |
| ----------- | --------------------------------------------------- | ------------ |
| Peter Grant | [pgrant@yahoo.com](mailto:pgrant@yahoo.com)         | 212-345-6789 |
| Leslie May  | [leslie_may@gmail.com](mailto:leslie_may@gmail.com) | 626-987-6543 |
| Aaron Burr  | `None`                                              | 303-456-7891 |

# Concatenate DateFrames

ê°€ë” ë°ì´í„°ì…‹ì´ ì—¬ëŸ¬ *DataFrame*ìœ¼ë¡œ ìª¼ê°œì§„ ê²½ìš°ê°€ ìˆìŠµë‹ˆë‹¤. ì´ë ‡ê²Œ ìª¼ê°œì§„ *DataFrame*ë“¤ì„ í•˜ë‚˜ì˜ *DataFrame*ìœ¼ë¡œ ë¬¶ê¸° ìœ„í•´ì„  `.concat()` í•¨ìˆ˜ë¥¼ í™œìš©í•˜ë©´ ë©ë‹ˆë‹¤.

```python
pd.concat(['df1', 'df2'])
```

ìœ„ í•¨ìˆ˜ëŠ” ì˜¤ì§ column ì´ ë™ì¼í•œ *DataFrame*ì— ëŒ€í•´ì„œë§Œ ì ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

# Review

ì§€ê¸ˆê¹Œì§€ Pandas ì—ì„œ ì—¬ëŸ¬ *DataFrame*ì„ ë‹¤ë£¨ëŠ” ë°©ë²•ì— ëŒ€í•´ì„œ ì•Œì•„ë³´ì•˜ìŠµë‹ˆë‹¤. ì§€ê¸ˆê¹Œì§€ ë°°ìš´ ë‚´ìš©ì„ ì •ë¦¬í•˜ë©´ ë‹¤ìŒê³½ ê°™ìŠµë‹ˆë‹¤.

- Creating a _DataFrame_ made by matching the common columns of two _DataFrames_ is called a `merge`
- We can specify which columns should be matches by using the keyword arguments `left_on` and `right_on`
- We can combine _DataFrames_ whose rows donâ€™t all match using `left`, `right`, and `outer` merges and the `how`keyword argument
- We can stack or concatenate _DataFrames_ with the same columns using `pd.concat`

ê³µë¶€í•˜ëŠ” ì£¼ê¸°ê°€ ì¤„ì–´ë“¤ê³  ìˆìŠµë‹ˆë‹¤..ğŸ˜… ì´ˆì‹¬ì„ ìƒì§€ ì•Šê³  ê³„ì†í•´ì„œ ê³µë¶€í•©ì‹œë‹¤ ğŸ‘

# References

- [Codecademy](http://www.codecademy.com)
